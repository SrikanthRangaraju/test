import java.io.*;
import java.util.*;
import java.util.stream.Collectors;

public class FilterCSV {
    public static void main(String[] args) {
        // Input file paths
        String txtFilePath = "headers.txt"; // Path to the text file with the list of headers
        String csvFilePath = "fileWithData.csv"; // Path to the CSV file
        String outputFilePath = "filteredData.csv"; // Output file path

        try {
            // Read the headers from the text file into a Set
            Set<String> requiredHeaders = new HashSet<>(readLinesFromFile(txtFilePath));

            // Read the CSV file and process it
            filterCSVByHeaders(csvFilePath, outputFilePath, requiredHeaders);

            System.out.println("Filtered CSV created: " + outputFilePath);
        } catch (Exception e) {
            System.err.println("Error: " + e.getMessage());
            e.printStackTrace();
        }
    }

    // Method to read lines from a file
    public static List<String> readLinesFromFile(String filePath) throws IOException {
        try (BufferedReader br = new BufferedReader(new FileReader(filePath))) {
            return br.lines().collect(Collectors.toList());
        }
    }

    // Method to filter the CSV by headers and write the filtered data to a new fi
