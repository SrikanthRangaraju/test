import java.nio.file.*

// Set the folder path where .txt files are stored
def folderPath = "C:\\Temp\\TextFiles"  // Update with your actual folder path

// Get the list of .txt files
def fileList = new File(folderPath).listFiles().findAll { it.name.endsWith(".txt") }

if (fileList.isEmpty()) {
    log.error("No .txt files found in the folder: " + folderPath)
} else {
    // Select a file sequentially or randomly
    def fileIndex = vars.get("fileIndex") ? vars.get("fileIndex").toInteger() + 1 : 0
    if (fileIndex >= fileList.size()) {
        fileIndex = 0  // Reset when all files are used
    }
    vars.put("fileIndex", fileIndex.toString())

    // Read file content
    def txtFile = fileList[fileIndex]
    def fileContent = new String(Files.readAllBytes(txtFile.toPath()), "UTF-8").trim()

    // Store content in JMeter variable
    vars.put("TXT_FILE_CONTENT", fileContent)

    log.info("Loaded file: " + txtFile.name)
    log.info("File Content: " + fileContent)
}
