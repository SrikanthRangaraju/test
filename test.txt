DO $$ 
DECLARE 
    idx_record RECORD;
BEGIN
    FOR idx_record IN 
        SELECT indexname, tablename, indexdef 
        FROM pg_indexes 
        WHERE schemaname = 'schema1'
    LOOP
        BEGIN
            -- Modify index definition to refer to schema2
            EXECUTE regexp_replace(idx_record.indexdef, 'ON schema1\.', 'ON schema2.', 'g');
        EXCEPTION 
            WHEN duplicate_object THEN 
                RAISE NOTICE 'Index % already exists on schema2.%', idx_record.indexname, idx_record.tablename;
            WHEN OTHERS THEN 
                RAISE WARNING 'Error creating index %: %', idx_record.indexname, SQLERRM;
        END;
    END LOOP;
END $$;
