import java.io.*;
import java.util.*;

public class CleanCSVSpecificColumn {

    public static void main(String[] args) {
        String inputFilePath = "path/to/input.csv"; // Replace with your actual file path
        String outputFilePath = "path/to/output.csv"; // Replace with your desired output file path
        String targetColumn = "marks"; // Replace with the column name you want to clean

        try {
            // Read the input file
            BufferedReader reader = new BufferedReader(new FileReader(inputFilePath));
            StringBuilder outputContent = new StringBuilder();

            // Read the header line
            String headerLine = reader.readLine();
            if (headerLine == null) {
                System.out.println("The file is empty.");
                return;
            }
            outputContent.append(headerLine).append("\n");

            // Get column index for the target column
            String[] headers = headerLine.split(",");
            int columnIndex = -1;
            for (int i = 0; i < headers.length; i++) {
                if (headers[i].trim().equalsIgnoreCase(targetColumn)) {
                    columnIndex = i;
                    break;
                }
            }

            if (columnIndex == -1) {
                System.out.println("Target column not found.");
                return;
            }

            // Process each row
            String line;
            while ((line = reader.readLine()) != null) {
                String[] values = line.split(",", -1); // Use -1 to preserve empty values
                if (columnIndex < values.length) {
                    // Clean the specific column value by reducing spaces to one
                    values[columnIndex] = values[columnIndex].replaceAll("\\s{2,}", " ").replace(" | ", "|");
                }
                outputContent.append(String.join(",", values)).append("\n");
            }
            reader.close();

            // Write the output to a new file
            BufferedWriter writer = new BufferedWriter(new FileWriter(outputFilePath));
            writer.write(outputContent.toString());
            writer.close();

            System.out.println("Processing complete. Output saved to: " + outputFilePath);

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
