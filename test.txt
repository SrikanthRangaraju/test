import java.io.*;
import java.util.regex.*;

public class CSVDataCleaner {
    public static void main(String[] args) {
        String inputFilePath = "C:\\User
        String outputFilePath = "C:\\Users\\

        try (BufferedReader reader = new BufferedReader(new FileReader(inputFilePath));
             BufferedWriter writer = new BufferedWriter(new FileWriter(outputFilePath))) {
            
            String line;
            while ((line = reader.readLine()) != null) {
                // Process line and clean numeric fields (including negative numbers)
                String cleanedLine = cleanNumericFields(line);
                writer.write(cleanedLine);
                writer.newLine();
            }
            
            System.out.println("CSV file has been cleaned and saved as: " + outputFilePath);

        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private static String cleanNumericFields(String line) {
        // Regular expression to match numbers with commas, including negatives (e.g., "-3,217.41")
        Pattern pattern = Pattern.compile("\"(-?\\d{1,3}(,\\d{3})*(\\.\\d+)?)\"");
        Matcher matcher = pattern.matcher(line);
        StringBuffer sb = new StringBuffer();

        while (matcher.find()) {
            String numericValue = matcher.group(1);  // Extract matched number
            String cleanedValue = numericValue.replace(",", ""); // Remove commas
            matcher.appendReplacement(sb, "\"" + cleanedValue + "\""); // Replace in line
        }
        matcher.appendTail(sb);

        return sb.toString();
    }
}
