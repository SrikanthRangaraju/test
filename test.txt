import java.io.*;
import java.util.*;

public class FilterCSV {
    public static void main(String[] args) throws IOException {
        // Specify the paths to your files
        String masterFilePath = "C:/Users/YourUsername/Documents/master.csv";
        String childFilePath = "C:/Users/YourUsername/Documents/child.csv";
        String outputFilePath = "C:/Users/YourUsername/Documents/filtered_master.csv";

        // Load child.csv IDs into a set
        Set<String> childIDs = new HashSet<>();
        try (BufferedReader br = new BufferedReader(new FileReader(childFilePath))) {
            String line;
            while ((line = br.readLine()) != null) {
                childIDs.add(line.trim());
            }
        }

        // Filter master.csv based on child.csv IDs
        try (BufferedReader br = new BufferedReader(new FileReader(masterFilePath));
             PrintWriter pw = new PrintWriter(new FileWriter(outputFilePath))) {
            String header = br.readLine();
            pw.println(header); // Write header to the new file
            String line;
            while ((line = br.readLine()) != null) {
                String[] columns = line.split(",");
                if (childIDs.contains(columns[0].trim())) {
                    pw.println(line);
                }
            }
        }
    }
}
