#!/bin/bash

# Define the folder containing the JSON files
folder_path="/path/to/your/folder"

# Loop through all JSON files in the folder
find "$folder_path" -type f -name "*.json" | while read -r file; do
  # Process each file: Remove the first and last lines and replace "response": { with {
  sed '1d;$d;s/"response": {/ {/' "$file" > "${file}.tmp"
  
  # Replace the original file with the processed content
  mv "${file}.tmp" "$file"
done

# Generate a timestamp in the format ddmmyyyy_currenttime
timestamp=$(date +"%d%m%Y_%H%M%S")

# Zip the folder with the timestamp
zip -r "${folder_path}_${timestamp}.zip" "$folder_path"

echo "Processing and zipping complete. Output: ${folder_path}_${timestamp}.zip"
