WITH Common_ruts AS (
  -- Get RUTs present in ALL 6 tables for camada = 202311
  SELECT rut FROM attr_score WHERE camada = 202311
  INTERSECT
  SELECT rut FROM chile_ruta WHERE camada = 202311
  INTERSECT
  SELECT rut FROM chile_per WHERE camada = 202311
  INTERSECT
  SELECT rut FROM chile_bra WHERE camada = 202311
  INTERSECT
  SELECT rut FROM attr_personas WHERE camada = 202311
  INTERSECT
  SELECT rut FROM attr_bra WHERE camada = 202311
)
SELECT
  cr.rut,
  a.mes_0,
  a.mes_6,
  a.mes_12,
  a.mean_score_7m,
  a.mean_score_13m,
  p.profesion,
  p.edad,
  b.suma_avaluo,
  b.total_avaluo_uf
FROM Common_ruts cr
-- Join tables with required columns
JOIN attr_score a 
  ON cr.rut = a.rut AND a.camada = 202311
JOIN attr_personas p 
  ON cr.rut = p.rut AND p.camada = 202311
JOIN attr_bra b 
  ON cr.rut = b.rut AND b.camada = 202311;
